(function(){function Wa(r) {
  var k = 0;
  return function() {
    return k < r.length ? {done:!1, value:r[k++],} : {done:!0};
  };
}
function ob(r) {
  var k = "undefined" != typeof Symbol && Symbol.iterator && r[Symbol.iterator];
  return k ? k.call(r) : {next:Wa(r)};
}
function Wb(r) {
  r = ["object" == typeof globalThis && globalThis, r, "object" == typeof window && window, "object" == typeof self && self, "object" == typeof global && global,];
  for (var k = 0; k < r.length; ++k) {
    var t = r[k];
    if (t && t.Math == Math) {
      return t;
    }
  }
  throw Error("Cannot find global object");
}
var X = Wb(this), Xb = "function" == typeof Object.defineProperties ? Object.defineProperty : function(r, k, t) {
  if (r == Array.prototype || r == Object.prototype) {
    return r;
  }
  r[k] = t.value;
  return r;
};
function Yb(r, k) {
  if (k) {
    a: {
      for (var t = X, x = r.split("."), y = 0; y < x.length - 1; y++) {
        var w = x[y];
        if (!(w in t)) {
          break a;
        }
        t = t[w];
      }
      x = x[x.length - 1];
      y = t[x];
      w = k(y);
      w != y && null != w && Xb(t, x, {configurable:!0, writable:!0, value:w});
    }
  }
}
Yb("Promise", function(r) {
  function k(g) {
    this.h = 0;
    this.j = void 0;
    this.g = [];
    this.H = !1;
    var m = this.s();
    try {
      g(m.resolve, m.reject);
    } catch (p) {
      m.reject(p);
    }
  }
  function t() {
    this.g = null;
  }
  function x(g) {
    return g instanceof k ? g : new k(function(m) {
      m(g);
    });
  }
  if (r) {
    return r;
  }
  t.prototype.h = function(g) {
    if (null == this.g) {
      this.g = [];
      var m = this;
      this.j(function() {
        m.u();
      });
    }
    this.g.push(g);
  };
  var y = X.setTimeout;
  t.prototype.j = function(g) {
    y(g, 0);
  };
  t.prototype.u = function() {
    for (; this.g && this.g.length;) {
      var g = this.g;
      this.g = [];
      for (var m = 0; m < g.length; ++m) {
        var p = g[m];
        g[m] = null;
        try {
          p();
        } catch (u) {
          this.s(u);
        }
      }
    }
    this.g = null;
  };
  t.prototype.s = function(g) {
    this.j(function() {
      throw g;
    });
  };
  k.prototype.s = function() {
    function g(u) {
      return function(z) {
        p || (p = !0, u.call(m, z));
      };
    }
    var m = this, p = !1;
    return {resolve:g(this.N), reject:g(this.u)};
  };
  k.prototype.N = function(g) {
    if (g === this) {
      this.u(new TypeError("A Promise cannot resolve to itself"));
    } else {
      if (g instanceof k) {
        this.P(g);
      } else {
        a: {
          switch(typeof g) {
            case "object":
              var m = null != g;
              break a;
            case "function":
              m = !0;
              break a;
            default:
              m = !1;
          }
        }
        m ? this.M(g) : this.G(g);
      }
    }
  };
  k.prototype.M = function(g) {
    var m = void 0;
    try {
      m = g.then;
    } catch (p) {
      this.u(p);
      return;
    }
    "function" == typeof m ? this.R(m, g) : this.G(g);
  };
  k.prototype.u = function(g) {
    this.K(2, g);
  };
  k.prototype.G = function(g) {
    this.K(1, g);
  };
  k.prototype.K = function(g, m) {
    if (0 != this.h) {
      throw Error("Cannot settle(" + g + ", " + m + "): Promise already settled in state" + this.h);
    }
    this.h = g;
    this.j = m;
    2 === this.h && this.O();
    this.U();
  };
  k.prototype.O = function() {
    var g = this;
    y(function() {
      if (g.L()) {
        var m = X.console;
        "undefined" !== typeof m && m.error(g.j);
      }
    }, 1);
  };
  k.prototype.L = function() {
    if (this.H) {
      return !1;
    }
    var g = X.CustomEvent, m = X.Event, p = X.dispatchEvent;
    if ("undefined" === typeof p) {
      return !0;
    }
    "function" === typeof g ? g = new g("unhandledrejection", {cancelable:!0}) : "function" === typeof m ? g = new m("unhandledrejection", {cancelable:!0}) : (g = X.document.createEvent("CustomEvent"), g.initCustomEvent("unhandledrejection", !1, !0, g));
    g.promise = this;
    g.reason = this.j;
    return p(g);
  };
  k.prototype.U = function() {
    if (null != this.g) {
      for (var g = 0; g < this.g.length; ++g) {
        w.h(this.g[g]);
      }
      this.g = null;
    }
  };
  var w = new t();
  k.prototype.P = function(g) {
    var m = this.s();
    g.A(m.resolve, m.reject);
  };
  k.prototype.R = function(g, m) {
    var p = this.s();
    try {
      g.call(m, p.resolve, p.reject);
    } catch (u) {
      p.reject(u);
    }
  };
  k.prototype.then = function(g, m) {
    function p(E, H) {
      return "function" == typeof E ? function(ma) {
        try {
          u(E(ma));
        } catch (da) {
          z(da);
        }
      } : H;
    }
    var u, z, ea = new k(function(E, H) {
      u = E;
      z = H;
    });
    this.A(p(g, u), p(m, z));
    return ea;
  };
  k.prototype["catch"] = function(g) {
    return this.then(void 0, g);
  };
  k.prototype.A = function(g, m) {
    function p() {
      switch(u.h) {
        case 1:
          g(u.j);
          break;
        case 2:
          m(u.j);
          break;
        default:
          throw Error("Unexpected state: " + u.h);
      }
    }
    var u = this;
    null == this.g ? w.h(p) : this.g.push(p);
    this.H = !0;
  };
  k.resolve = x;
  k.reject = function(g) {
    return new k(function(m, p) {
      p(g);
    });
  };
  k.race = function(g) {
    return new k(function(m, p) {
      for (var u = ob(g), z = u.next(); !z.done; z = u.next()) {
        x(z.value).A(m, p);
      }
    });
  };
  k.all = function(g) {
    var m = ob(g), p = m.next();
    return p.done ? x([]) : new k(function(u, z) {
      function ea(ma) {
        return function(da) {
          E[ma] = da;
          H--;
          0 == H && u(E);
        };
      }
      var E = [], H = 0;
      do {
        E.push(void 0), H++, x(p.value).A(ea(E.length - 1), z), p = m.next();
      } while (!p.done);
    });
  };
  return k;
});
Yb("Math.trunc", function(r) {
  return r ? r : function(k) {
    k = Number(k);
    if (isNaN(k) || Infinity === k || -Infinity === k || 0 === k) {
      return k;
    }
    var t = Math.floor(Math.abs(k));
    return 0 > k ? -t : t;
  };
});
Yb("Array.from", function(r) {
  return r ? r : function(k, t, x) {
    t = null != t ? t : function(m) {
      return m;
    };
    var y = [], w = "undefined" != typeof Symbol && Symbol.iterator && k[Symbol.iterator];
    if ("function" == typeof w) {
      k = w.call(k);
      for (var g = 0; !(w = k.next()).done;) {
        y.push(t.call(x, w.value, g++));
      }
    } else {
      for (w = k.length, g = 0; g < w; g++) {
        y.push(t.call(x, k[g], g));
      }
    }
    return y;
  };
});
xx.module("edu", function(r) {
  function k() {
    return new Promise(function(a) {
      Promise.all([Xa.fetchTheFolders(), t()]).then(function() {
        a();
      });
      x();
      h.transfer_needed_variables({th:Da, bh:Ea, tbh:pb, putTopdiv:g});
      y();
      qb = Math.round((Math.round(d._("opt_num7").offsetHeight) - 12) / 2);
      var c = d._("opt_get_height");
      c.classList.remove("opt_class");
      c.classList.add("nodisplay");
      w();
      p();
    });
  }
  function t() {
    return new Promise(function(a) {
      if ("undefined" === typeof localStorage) {
        h.doFetch("ft_temp.php", "setCompID", null, {}).then(function(b) {
          "success" === b.value ? xx.vars.compid = b.W : void 0 != b.errmsg ? A.debugon && alert(b.errmsg) : A.debugon && alert("There was a problem with Ajax call");
          a();
        })["catch"](function(b) {
          alert("error in fixCompid, no local storage = " + b);
        });
      } else {
        var c = localStorage.getItem("compID");
        c ? c = parseInt(c, 10) : (c = h.random(68000000, 675999000), localStorage.setItem("compID", c));
        xx.vars.compid = c;
        h.doFetch("ft_temp.php", "setSessionCompID", null, {compID:xx.vars.compid}).then(function(b) {
          "success" !== b.value && (void 0 != b.errmsg ? A.debugon && alert(b.errmsg) : A.debugon && alert("There was a problem with Ajax call"));
          a();
        })["catch"](function(b) {
          alert("error in fixCompid, localstorage = " + b);
        });
      }
    });
  }
  function x() {
    var a = d._("siteName"), c = d._("pageName");
    a.textContent = Ya.siteVars.siteName;
    c.textContent = Ya.siteVars.pageName;
    a = d._("bodymask");
    a.style.width = screen.width + "px";
    a.style.height = screen.height + "px";
    a = d._("topdiv");
    rb = a.querySelector("#siteName").offsetWidth;
    S = a.querySelector("#pageName").offsetWidth;
    130 > S && (S = 130);
    Fa = d.getOffsetWidth(d._("scorecontainer"));
    a = a.querySelector("#theMenu");
    na = a.offsetWidth;
    c = d._("topmenumask");
    c.style.width = na + "px";
    c.style.height = a.offsetHeight + "px";
    c = d._("toprightmenumask");
    c.style.width = na - a.firstChild.offsetWidth + "px";
    c.style.height = a.offsetHeight + "px";
    a = d._("gobutton");
    Za = a.offsetWidth;
    c = d._("gamecontainermask");
    c.style.width = Za + "px";
    c.style.height = a.offsetHeight + "px";
    Da = d._("topdiv").offsetHeight;
    Ea = d._("bottomdiv").offsetHeight;
    pb = Da + Ea;
    d._("wrappermask").style.top = Da + "px";
    d._("wrappermask").style.bottom = Ea + "px";
  }
  function y() {
    function a(c, b, e) {
      var f = new h.Slider1(c, b, e);
      f.initBall();
      "cont" === c ? d._("cont").addEventListener("click", function(l) {
        f.moveBall(l);
        sb();
      }) : d._(c).addEventListener("click", function(l) {
        f.moveBall(l);
      });
      return f;
    }
    Ga = a("cont", "ball", 0.2);
    Ha = a("cont_v1", "ball_v1", fa.r1);
    Ia = a("cont_v2", "ball_v2", fa.r2);
    Ja = a("cont_v3", "ball_v3", fa.T);
  }
  function w() {
    var a = d._("wrapper");
    a.style.backgroundImage = "none";
    a.innerHTML = h.getHtml("tem_info");
    h.checkHeight();
    h.checkWidth();
  }
  function g(a) {
    var c = Math.round(0.05 * a);
    d.qs("#topdiv #siteName").style.left = c - 2 + "px";
    c += rb;
    d.qs("#topdiv p#pageName").style.left = c + "px";
    c += S;
    var b = 0.92 * (a - na - Za), e = (c + b - Fa) / 2 - 4;
    e > b - Fa - 5 ? (e = b - Fa - 5, d._("pageName").style.width = e - (c - S) - 10 + "px") : d._("pageName").style.width = "auto";
    d._("scorecontainer").style.left = e + "px";
    d._("topmenucontainer").style.left = b + "px";
    d._("gamecontainer").style.left = b + na + 0.025 * a + "px";
  }
  function m() {
    d._("topmenumask").classList.remove("nodisplay");
  }
  function p() {
    d._("topmenumask").classList.add("nodisplay");
  }
  function u(a) {
    var c = a.key;
    c = c.replace(/[- _./\|,:\\]/g, "");
    if (12 != c.length) {
      return !1;
    }
    a = a.V;
    a = a.replace(/-/g, "");
    a = z(a);
    return a != c ? !1 : !0;
  }
  function z(a) {
    var c = parseInt(a.substr(0, 6), 10);
    if (100000 > c) {
      return null;
    }
    a = a.substr(a.length - 2);
    for (var b, e = 1; 0 <= e; e--) {
      c *= 26;
      b = a.charCodeAt(e) - 65;
      if (0 > b || 25 < b) {
        return null;
      }
      c += b;
    }
    a = $a[1];
    b = $a[2];
    for (c = a > b ? Math.trunc(c / a) * b : Math.trunc(c / b) * a; 99999999 < c;) {
      c = Math.trunc(c / 7);
    }
    e = [];
    e[1] = String(c);
    for (c = a * b; 9999 < c;) {
      c = Math.trunc(c / 6);
    }
    e[2] = String(c);
    return ea(e);
  }
  function ea(a) {
    var c = "", b = [], e, f;
    b[1] = a[1].length;
    b[2] = a[2].length;
    if (b[1] > b[2]) {
      var l = 1;
      var n = 2;
    } else {
      n = 1, l = 2;
    }
    var C = Math.trunc(b[l] / b[n]);
    for (f = e = 0; f < b[n]; f++) {
      c = c + a[l].substr(e, C) + a[n].substr(f, 1), e += C;
    }
    return c + a[l].substr(e);
  }
  function E() {
    return new Promise(function(a) {
      M = window.location.origin + "/" + N.substr(0, N.lastIndexOf(".")) + "_files/";
      var c = null;
      "undefined" !== typeof localStorage && (c = localStorage.getItem(N));
      h.doFetch("ft_temp.php", "openfile", null, {fpath:N, stored:c}, "Reading the file, please wait").then(function(b) {
        "success" === b.value ? (tb = b.subject, oa = b.settings, Y = b.numCats, I = b.catArr, ub = b.totalQs, ha = b.isRestricted, F = b.dcontact, $a = b.codeBytes, ab = b.nFreeAccessQs, vb = b.data, wb = b.ptrArr, Ka = b.cdArr, xb = b.ansCoder, yb = b.textColor, bb = b.fontName, zb = b.fontSize, cb[1] = 0 !== b.fontBold[1], cb[2] = 0 !== b.fontBold[2], db[1] = 0 !== b.fontUnderline[1], db[2] = 0 !== b.fontUnderline[2], eb[1] = 0 !== b.fontItalic[1], eb[2] = 0 !== b.fontItalic[2], fb = b.FrameBorderWidth, 
        Ab = b.FrameBackColor, Bb = b.FrameBorderColor, O = b.backgroundPicture, "" != O && (O = O.substr(1)), La = b.backgroundStyle, ia = b.backgroundColor, pa = b.backgroundSound, "" != pa ? (pa = M + pa.substr(1), d._("back_sound").setAttribute("src", pa), qa = !0) : qa = !1, ra = b.backQTimeSound, "" != ra ? (ra = M + ra.substr(1), d._("backQTime_sound").setAttribute("src", ra), Ma = !0) : Ma = !1, Cb = b.keyForecolor, Db = b.keyBackcolor, Eb = b.keyBordercolor, Fb = b.fenceTLcolor, Gb = b.fenceBRcolor, 
        Hb = b.tickColor, sa = b.pwString, b = d._("pageName"), b.innerHTML = tb, S = b.offsetWidth, 130 > S && (S = 130), g(getComputedStyle(document.body, null).width.replace("px", "")), document.getElementById("fn_output").value = N.substring(N.lastIndexOf("/") + 1), a("good")) : a("bad");
      })["catch"](function(b) {
        a("bad");
        alert("error = " + b);
      });
    });
  }
  function H(a) {
    if (isNaN(a) || 0 >= a || 0 <= a.indexOf("e")) {
      return !0;
    }
  }
  function ma() {
    return new Promise(function(a) {
      if ("" === O) {
        a();
      } else {
        var c = new Image();
        c.onload = function() {
          a();
          Ib();
        };
        c.onerror = function() {
          a();
        };
        c.src = M + O;
      }
      Na = Oa = T = 0;
      c = ".q_cell_text{" + Jb(1) + Kb(1) + "}";
      var b = h.rgbaColor(Fb) + " ", e = h.rgbaColor(Gb) + " ";
      c = c + (".opt_class2:hover, .on_div{background-color:rgba(120,120,120,0.2);border-color:" + b + e + e + b + "}") + (".o_cell_text{" + Jb(2) + Kb(2) + "}");
      c += ".n_format2{color:" + h.rgbaColor(Cb) + "; background-color:" + h.rgbaColor(Db) + "; border-color:" + h.rgbaColor(Eb) + "}";
      d.qs("style").innerHTML = c;
      d._("wrapper").style.backgroundColor = h.rgbaColor(ia);
    });
  }
  function da() {
    B = 0;
    0 !== Z && (-1 === Z ? (d._("wrapper").style.backgroundImage = "none", P = "") : 2 === Z ? (d._("wrapper").style.backgroundImage = " url(" + Pa + ")", P = Q) : 3 === Z ? (d._("wrapper").style.backgroundImage = " url(" + Pa + ")", gb(ja), P = Q) : 4 === Z ? Ib() : 1 === Z && gb(ja));
    Qa();
    document.getElementById("wrapper").innerHTML = Lb;
    aa = T % 2;
    Ra = Mb;
    Zb(ta);
    h.checkHeight();
    h.checkWidth();
    T++;
  }
  function gb(a) {
    J = a;
    0 === J ? d._("wrapper").style.backgroundSize = "100% 100%" : 1 === J ? d._("wrapper").style.backgroundSize = "cover" : 2 === J ? d._("wrapper").style.backgroundSize = "contain" : 3 === J && (d._("wrapper").style.backgroundSize = "auto");
  }
  function Zb(a) {
    "undefined" === typeof a && (a = "30");
    3599 < a && (a = 3599);
    0 === a && (a = 1);
    var c = {};
    c.v = Math.floor(a / 60);
    c.i = a % 60;
    c.J = !1;
    Nb(c);
    Sa = setInterval(function() {
      c.i--;
      Nb(c);
      c.J && (clearInterval(Sa), 0 === B && (d.removeAllClasses("#wrapper .opt_class", "opt_class2"), hb("wrong", "Time up")));
    }, 1000);
  }
  function hb(a, c) {
    c = void 0 === c ? "Wrong" : c;
    B = -1;
    d._("wrappermask").classList.remove("nodisplay");
    var b = document.createElement("div");
    b.setAttribute("style", "font-size:1.3em;z-index:400;color:" + h.rgbaColor(Hb) + ";position:absolute;top: " + qb + "px;left:36px;");
    b.textContent = "\u2714";
    d.qs("div#opt_num" + Ra).insertAdjacentElement("afterend", b);
    "correct" === a ? (ua && Ob.play(), Pb("Correct, well done!", 700, "good"), Na++) : (ua && Qb.play(), Pb(c + ", number " + Ra + " is correct", 1000, "h"));
    d._("thescore").innerHTML = Na + "/" + T;
    T >= ba ? (d._("thescore").style.backgroundColor = "red", setTimeout(function() {
      var e = d._("endbox");
      e.querySelector("p#endmsg").innerHTML = "Game over...<br>You scored " + Na + "/" + T + "<br>";
      h.centreBoxAndShow(e);
    }, 1000)) : B = 1;
    $b(U);
    Qa();
  }
  function Nb(a) {
    if (0 === a.v) {
      0 >= a.i && (a.J = !0);
      var c = a.i;
    } else {
      0 > a.i && (a.i = 59, a.v--), 0 === a.v ? c = a.i : c = 10 > a.i ? a.v + ":0" + a.i : a.v + ":" + a.i;
    }
    document.getElementById("clock").value = c;
  }
  function Ib() {
    P = O;
    J = La;
    d._("wrapper").style.backgroundImage = "url(" + M + P + ")";
    gb(J);
  }
  function ib() {
    return new Promise(function(a) {
      var c = 0, b, e = setInterval(function() {
        0 === c && (c = 1, b = ac());
        b.then(function(f) {
          clearInterval(e);
          a(f);
        })["catch"](function() {
          c = 0;
        });
      }, 50);
    });
  }
  function ac() {
    return new Promise(function(a, c) {
      var b = va - Oa;
      0 === b && a("end");
      var e = Oa % 2;
      Oa++;
      var f = h.random(1, b), l = {}, n = {}, C = wa[f];
      wa[f] = wa[b];
      bc(C, l, n).then(function() {
        var K = l.B, D = l.S;
        Z = cc();
        var v = oa.Q_W[D], jb = oa.Q_H[D], R = Rb(v, jb, n, D, 0), kb = "" === l.m[6] ? "nodisplay_important" : "", xa = "";
        "" === n.clipPath[0] ? ka[e][0] = !1 : (ka[e][0] = !0, V[e][0].src = M + n.clipPath[0].substr(1), xa = '<img src="res/soundnew.gif">');
        R = {si:xa, offstyle:kb, q:l.m[6], n:0, p0:R};
        var lb = h.getHtml("tem_q", R), dc = l.o;
        lb += '<div class="opts" >';
        v = oa.A_W[D];
        jb = oa.A_H[D];
        for (var ca = 1; ca <= K; ca++) {
          var ya = dc[ca];
          R = Rb(v, jb, n, D, ya);
          kb = "" === l.m[ya] ? "nodisplay_important" : "";
          "" === n.clipPath[ya] ? (ka[e][ca] = !1, xa = "") : (ka[e][ca] = !0, V[e][ca].src = M + n.clipPath[ya].substr(1), xa = '<img src="res/soundnew.gif">');
          R = {si:xa, offstyle:kb, opt:l.m[ya], n:ca, pn:R};
          R = h.getHtml("tem_opt", R);
          lb += R;
        }
        Lb = lb + "</div>";
        Mb = l.F;
        a("ok");
      })["catch"](function() {
        c("bad picture");
      });
    });
  }
  function cc() {
    if ("" === Q) {
      if ("" === O) {
        return "" === P ? 0 : -1;
      }
      if ("" === P) {
        return 4;
      }
      if (P === O) {
        if (La === J) {
          return 0;
        }
        ja = La;
        return 1;
      }
      return 4;
    }
    return Q === P ? ja === J ? 0 : 1 : ja === J ? 2 : 3;
  }
  function Jb(a) {
    var c = cb[a] ? "bold " : "", b = db[a] ? "underline " : "", e = eb[a] ? "italic " : "", f = zb[a] + "pt ", l = "" === bb[a] ? "sans-serif" : bb[a] + ",sans-serif";
    return "color:" + h.rgbaColor(yb[a]) + "; font:" + c + b + e + f + l + ";";
  }
  function Kb(a) {
    if (0 > fb[a]) {
      return "";
    }
    var c = fb[a] + "px solid " + h.rgbaColor(Bb[a]) + ";";
    return "padding:12px 20px;background-color:" + h.rgbaColor(Ab[a]) + "; border:" + c;
  }
  function Rb(a, c, b, e, f) {
    var l = "";
    if ("" != b.l[f]) {
      e = b.width[f];
      var n = b.height[f];
      if (0 < e && 0 < n) {
        0 >= a && (a = e);
        0 >= c && (c = n);
        if (a < e || c < n) {
          l = e / n, a < e && c < n ? a / c > l ? (n = c, e = Math.round(n * l)) : (e = a, n = Math.round(e / l)) : a < e ? (e = a, n = Math.round(e / l)) : (n = c, e = Math.round(n * l));
        }
        a = "";
        c = b.D[f];
        0 < c && (a = "border:solid " + c + "px " + h.rgbaColor(b.I[f]) + ";");
        l = '<div class="qo_cell_picture"><img src="' + b.C[f] + '" \n          width="' + e + '" height="' + n + '" alt="" style="vertical-align:middle;' + a + '">\n          </div>';
      }
    }
    return l;
  }
  function Pb(a, c, b) {
    void 0 === c && (c = 1000);
    void 0 === b ? b = "#e55" : "good" === b ? b = "#dfd" : "w" === b ? b = "#fe8" : "b" === b ? b = "#faa" : "h" === b && (b = "#ccc");
    var e = d._("flashbox");
    e.querySelector("p#flashmsg").innerHTML = a + "<br><br>";
    e.style.backgroundColor = b;
    h.centreBoxAndShow(e);
    setTimeout(function() {
      e.classList.add("nodisplay");
    }, c);
  }
  function ec(a, c) {
    var b = 0;
    if (ha) {
      for (var e = 0; b < ub && b < ab;) {
        e++;
        for (var f = 1; f <= Y && !(e <= I[f].n && (a[++b] = I[f].q[e]), b >= ab); f++) {
        }
      }
    } else {
      for (e = 1; e <= Y; e++) {
        if (I[e].selected) {
          for (f = 1; f <= I[e].n; f++) {
            a[++b] = I[e].q[f];
          }
        }
      }
    }
    c.n = b;
    return !0;
  }
  function bc(a, c, b) {
    return new Promise(function(e, f) {
      fc(a, c, b);
      b.C = [];
      var l = !0, n = c.B + 2;
      Q = b.l[7];
      "" != Q ? (ja = b.D[7], Q = Q.substr(1), Pa = M + Q, b.C[7] = Pa, Sb(b, 7).then(function() {
        0 === --n && (l ? e() : f());
      })) : 0 === --n && (l ? e() : f());
      for (var C = 0; C <= c.B; C++) {
        "" != b.l[C] ? (b.C[C] = M + b.l[C].substr(1), Sb(b, C).then(function(K) {
          "Bad image" === K && f();
          0 === --n && (l ? e() : f());
        })["catch"](function() {
          f();
          l = !1;
        })) : 0 === --n && (l ? e() : f());
      }
    });
  }
  function Sb(a, c) {
    return new Promise(function(b) {
      var e = new Image();
      e.onload = function() {
        a.width[c] = this.width;
        a.height[c] = this.height;
        b();
      };
      e.onerror = function() {
        b("Bad image");
      };
      e.src = a.C[c];
    });
  }
  function fc(a, c, b) {
    var e = [];
    a = wb[a];
    var f = a.off;
    a = a.len;
    for (var l = 1; l <= a; l++) {
      e[l] = vb[f + l];
    }
    f = e[a];
    l = Ka.low;
    for (var n = Ka.high, C = Ka.sum1, K, D = 1; D < a; D++) {
      f = K = f > e[D] ? e[D] + 256 - f : e[D] - f, K > l && K < n && (K = C - K), e[D] = K;
    }
    a = [];
    f = {p:3};
    b.l = [];
    b.clipPath = [];
    b.D = [];
    b.I = [];
    b.width = [];
    b.height = [];
    c.m = [];
    b.l[0] = G(e, f, !0);
    Ta(e, f, 0, b);
    b.clipPath[0] = G(e, f, !0);
    c.m[6] = G(e, f, !0);
    for (l = 1; l <= e[1]; l++) {
      b.l[l] = G(e, f, !0), Ta(e, f, l, b), b.clipPath[l] = G(e, f, !0), c.m[l] = G(e, f, !1), a[l] = 1 === e[f.p] ? !0 : !1, f.p += 1;
    }
    b.l[6] = G(e, f, !0);
    Ta(e, f, 6, b);
    b.clipPath[6] = G(e, f, !0);
    c.m[7] = G(e, f, !0);
    b.l[7] = G(e, f, !0);
    Ta(e, f, 7, b);
    b.clipPath[7] = G(e, f, !0);
    b = c.m[6];
    var v;
    "" === b ? v = " " : v = b;
    c.F = Math.round(e[f.p] / (v.charCodeAt(0) % xb + 1));
    c.B = e[1];
    c.S = e[2];
    c.o = [];
    v = 0;
    b = [];
    e = c.B;
    for (f = 1; f <= e; f++) {
      a[f] ? c.o[f] = f : (c.o[f] = 0, v++, b[v] = f);
    }
    if (0 !== v) {
      for (a = 1; 1 < v;) {
        for (; 0 !== c.o[a];) {
          a++;
        }
        f = h.random(1, v);
        c.o[a] = b[f];
        b[f] = b[v];
        v--;
      }
      for (; 0 !== c.o[a];) {
        a++;
      }
      c.o[a] = b[1];
      for (v = 1; v <= e; v++) {
        if (c.o[v] === c.F) {
          c.F = v;
          break;
        }
      }
    }
  }
  function Ta(a, c, b, e) {
    e.D[b] = a[c.p];
    7 != b && (e.I[b] = 0 < e.D[b] ? a[c.p + 1] + 256 * a[c.p + 2] + 65536 * a[c.p + 3] : 0);
    c.p += 4;
  }
  function G(a, c, b) {
    var e = a[c.p];
    b && (c.p += 1, e += 256 * a[c.p]);
    b = "";
    for (var f = 1; f <= e; f++) {
      b += String.fromCharCode(a[c.p + f]);
    }
    c.p = c.p + e + 1;
    return b;
  }
  function sb() {
    var a = Ga.sl_r * Ha.sl_r;
    Ob.volume = a;
    Qb.volume = a;
    a = Ga.sl_r * Ia.sl_r;
    W.volume = a;
    la.volume = a;
    Ua.volume = a;
    a = Ga.sl_r * Ja.sl_r;
    Array.from(d.qa("#clips0 audio")).forEach(function(c) {
      c.volume = a;
    });
    Array.from(d.qa("#clips1 audio")).forEach(function(c) {
      c.volume = a;
    });
  }
  function Tb(a, c) {
    a.stopPropagation();
    a.preventDefault();
    var b = parseInt(c.id.charAt(c.id.length - 1), 10);
    ka[aa][b] && (V[aa][b].pause(), Va = -1);
  }
  function Ub(a, c) {
    a.stopPropagation();
    a.preventDefault();
    var b = parseInt(c.id.charAt(c.id.length - 1), 10);
    ka[aa][b] && (V[aa][b].currentTime = 0, V[aa][b].play(), Va = b);
  }
  function $b(a) {
    1 > a || (1 === a ? W.pause() : 2 === a ? la.pause() : Ua.pause());
  }
  function Qa() {
    ua && (0 === B ? Ma && (1 === U && W.pause(), la.play(), U = 2) : qa ? (W.play(), U = 1) : U = 0);
  }
  var A = xx.vars, d = xx.q, h, Ya, Xa;
  xx.imports.push(function() {
    h = xx.common;
    Ya = xx.meta;
    Xa = xx.myExpl;
  });
  r.extend({checkopenfile:function(a, c) {
    c = void 0 === c ? "" : c;
    h.hideDialog("myExplorer");
    "Cancel" !== a && "" !== c && c !== N && (d._("toprightmenumask").classList.add("nodisplay"), d._("gamecontainermask").classList.add("nodisplay"), N = c, E(a).then(function(b) {
      if ("bad" === b) {
        h.showMessage({msg:"Problem with opening the file", bc:"w"});
      } else if ("cancel" !== b && "good" === b && (0 > ia && (ia = 300000), d._("wrapper").style.backgroundColor = h.rgbaColor(ia, 0.6), mb = 0, ha)) {
        b = "<b>Name: " + F[1] + "</b><br>";
        b += "<b>Contact: " + F[2];
        "" != F[3] && (b += ", " + F[3]);
        "" != F[4] && (b += ", " + F[4]);
        "" != F[5] && (b += ", " + F[5]);
        "" != F[6] && (b += ", " + F[6]);
        b += "</b>";
        d._("contactdetails").innerHTML = b;
        var e = A.compid;
        b = String.fromCharCode(65 + e % 26);
        e = Math.trunc(e / 26);
        b += String.fromCharCode(65 + e % 26);
        e = Math.trunc(e / 26);
        b = e + "-" + b;
        d._("gcode_input1").value = b;
        d._("gcode_input2").value = d._("fn_output").value;
        d._("gcode_input3").value = "";
        h.showDialog("unlockbox");
        d._("gcode_input3").focus();
      }
    }));
  }, OpenFile:function() {
    h.showDialog("myExplorer");
  }, Categories:function() {
    var a = ["#eee", "#fff"];
    for (var c = '<div id="catlistDialog" style="background-color: ' + a[(Y + 1) % 2] + ' ">\n    <div style="background-color:#666; color:white;">\n    <div class="cat_name">Category</div>\n    <div class="numQs">Qs</div>\n    <div class="selected_cb" style="padding-left:0;">Selected</div></div>', b = 1; b <= Y; b++) {
      c += '<div style="background-color:' + a[b % 2] + '">\n     <div class="cat_name" >' + b + ") " + I[b].name + '</div>\n     <div  class="numQs">' + I[b].n + '</div>\n     <div class="selected_cb"><input type="checkbox"' + (ha ? 'disabled="true" ' : "") + (!0 === I[b].selected ? "checked" : "") + "></div></div>";
    }
    c += "<br>";
    c = ha ? c + '<div style="margin-right:3%">\n      <button class="butt_class1" style="padding:2px 10px;">OK</button>\n      </div>' : c + '<div style="margin-right:3%">\n      <button id="sa1" class="butt_class1">Select all</button>\n      <button id="sn1" class="butt_class1">Select none</button>\n      </div>\n      <div style="clear:right;margin-right:3%">\n      <button id="catlist_save" class="butt_class1" style="padding:2px 10px;" >Apply</button>\n      <button id="catlist_cancel" class="butt_class1" style="padding:2px 10px;">Cancel</button>\n      </div>';
    a = c + "</div>";
    document.getElementById("catlist_container").innerHTML = a;
    h.showDialog("catlist_container");
    za = !1;
  }, Numberofquestions:function() {
    d._("gnq1_input").value = "20";
    Aa = d._("gnq2_input").value = Ba;
    h.showDialog("getnumqs");
  }, Timeallowed:function() {
    d._("gta1_input").value = "30";
    Ca = d._("gta2_input").value = ta;
    h.showDialog("gettimeallowed");
  }, Audiovolume:function() {
    h.showDialog("getaudiovolume");
  },});
  var Vb = !1, rb, S, Fa, na, Za, Da, Ea, pb, qb, Ga, Ha, Ia, Ja, Ob = d._("correct_clip"), Qb = d._("wrong_clip");
  window.onload = function() {
    xx.fixImports();
    h.makemenu();
    Xa.init(xx.edu, 1);
    k().then(function() {
      m();
      h.showDialog("startupbox");
      d.qs("body").removeChild(d._("startupDiv"));
    });
  };
  d.delegate("wrapper", "click", ".info_class", function() {
    this.nextElementSibling.nextElementSibling.classList.toggle("nodisplay");
    h.checkHeight();
    h.checkWidth();
  });
  document.onkeydown = function(a) {
    if (!(0 < h.isLoadingOn())) {
      if (window.event) {
        var c = window.event.keyCode;
      } else {
        a && (c = a.which);
      }
      a = a || window.event;
      a.altKey && (83 === c ? (A.isLocal ? A.debugon = !A.debugon : !0 === A.debugon ? A.debugon = !1 : Vb && !1 === A.debugon && (A.debugon = !0), A.debugon ? d._("debug").style.display = "" : d._("debug").style.display = "none") : 76 !== c || A.debugon && "" === document.getElementById("fn_output").value || "" === document.getElementById("fn_output").value || !d._("dialogmask").classList.contains("nodisplay") || "New game" !== L || 5 < ++mb || (d._("clb1_input").value = d._("fn_output").value, 
      d._("clb2_input").value = "", h.showDialog("creatorloginbox"), d._("clb2_input").focus()));
    }
  };
  d._("pageName").addEventListener("click", function() {
    Vb = !0;
    setTimeout("canDebug = false", 5000);
  });
  d.delegate("startupbox", "click", "button", function() {
    "Accept" === this.innerHTML ? (h.hideDialog("startupbox"), p()) : location.replace("https://www.google.com");
  });
  d.delegate("unlockbox", "click", "button", function() {
    if ("Next" === this.textContent) {
      var a = d.qa("#unlockbox input");
      u({cid:a[0].value, key:a[2].value}) ? (a = 0, "undefined" === typeof localStorage ? a = 1 : localStorage.setItem(N, xx.vars.compid), h.doFetch("ft_temp.php", "setFree", null, {doCookie:a}).then(function() {
        ha = !1;
        h.showMessage({msg:"Correct key", bc:"g", callback1:function() {
          h.hideDialog("unlockbox");
        },});
      })["catch"](function(c) {
        alert("error from setFree = " + c);
      })) : h.showMessage({msg:"Wrong key", bc:"b"});
    } else {
      h.hideDialog("unlockbox");
    }
  });
  d.delegate(document.body, "keypress", "#unlockbox", function(a) {
    h.enterKeyOnInput(a, this) && (a = document.createEvent("HTMLEvents"), a.initEvent("click", !0, !1), d.qs("#unlockbox button").dispatchEvent(a));
  });
  var mb;
  d.delegate("creatorloginbox", "click", "button", function() {
    if ("Next" === this.textContent) {
      var a = d.qa("#creatorloginbox input");
      var c = a[0].value;
      a = a[1].value;
      if ("" === sa || 0 === sa.length) {
        a = !1;
      } else {
        c = c.toLowerCase();
        var b = [];
        var e = a.length;
        b[1] = 3 > e ? a + "XXX".substr(0, 3 - e) : a;
        a = c.lastIndexOf(".");
        b[2] = ".vna" === c.substr(a) ? c.substr(a) + "qna" : c;
        a = ea(b);
        c = a.length;
        b = Math.trunc((100 - c) / 7);
        2 > b && (b = 2);
        b: {
          var f = sa.substr(0, b);
          for (b = 0; b < c; b++) {
            var l = f.charCodeAt(b) - 97;
            if (0 >= l) {
              a = "";
              break b;
            }
            for (e = a.charCodeAt(b);;) {
              var n = e % l;
              f += String.fromCharCode(n + 100);
              e = Math.trunc(e / l);
              if (4 > n) {
                if (l = n + 5, 2 > n) {
                  if (25 < c) {
                    break;
                  }
                } else {
                  if (35 < c) {
                    break;
                  }
                }
              } else {
                l = n;
              }
              if (0 === e) {
                break;
              }
            }
          }
          a = f;
        }
        a = a != sa ? !1 : !0;
      }
      a ? (h.hideDialog("creatorloginbox"), d._("gqkb2_input").value = d._("fn_output").value, d._("gqkb1_input").value = "", d._("gqkb3_input").value = "", h.showDialog("getqnakeybox"), d._("gqkb1_input").focus()) : (h.showMessage({msg:"Wrong password"}), 5 < ++mb && h.hideDialog("creatorloginbox"));
    } else {
      h.hideDialog("creatorloginbox");
    }
  });
  d.delegate(document.body, "keypress", "#creatorloginbox", function(a) {
    h.enterKeyOnInput(a, this) && (a = document.createEvent("HTMLEvents"), a.initEvent("click", !0, !1), d.qs("#creatorloginbox button").dispatchEvent(a));
  });
  d.qs("#getqnakeybox button").addEventListener("click", function() {
    if ("Calculate key" === this.textContent) {
      d.qs("#gqkb3_input").value = "";
      var a = d.qa("#getqnakeybox input");
      var c = a[0].value;
      c = c.replace(/[- _./\|,:\\]/g, "");
      if (8 != c.length) {
        c = !1;
      } else {
        if (c = c.toUpperCase(), c = z(c), null == c) {
          c = !1;
        } else {
          var b = c.substr(0, 4) + "-" + c.substr(4, 4) + "-" + c.substr(8);
          c = !0;
        }
      }
      c ? a[2].value = b : h.showMessage({msg:"Bad computer ID", bc:"b"});
    } else {
      h.hideDialog("getqnakeybox");
    }
  });
  var N, M, tb, oa, Y, I, ub, ha, ab, vb, wb, $a, Ka, xb, yb, bb, zb, cb = [], db = [], eb = [], fb, Ab, Bb, O, La, ia, pa, ra, Cb, Db, Eb, Fb, Gb, Hb, sa, F, za;
  d.delegate("catlist_container", "click", "button", function() {
    var a = this.textContent;
    if ("Select all" === a || "Select none" === a) {
      a = "Select all" === a;
      for (var c = d.qa("#catlist_container input"), b = 0; b < c.length; b++) {
        c[b].checked = a;
      }
      za = !0;
    } else {
      if (h.hideDialog("catlist_container"), "Apply" === a && za) {
        c = d.qa("#catlist_container input");
        a = [];
        for (b = 0; b < c.length; b++) {
          a[b] = c[b].checked;
        }
        if (Y === a.length) {
          for (c = 0; c < Y; c++) {
            I[c + 1].selected = a[c];
          }
          za = !1;
        } else {
          alert("There was a problem with the Category list");
        }
      }
    }
  });
  d.delegate("catlist_container", "change", "input", function() {
    za = !0;
  });
  var Ba = "20", Aa;
  d.delegate("getnumqs", "click", "button", function() {
    var a = this.textContent;
    "Reset" === a ? (Aa = Ba = "20", d._("gnq2_input").value = Ba) : (h.hideDialog("getnumqs"), "Apply" === a && (Ba = Aa));
  });
  d.delegate(document.body, "keyup", "#gnq2_input", function(a) {
    a = a.target.value;
    H(a) ? d._("gnq2_input").value = Aa : Aa = a;
  });
  var ta = "30", Ca;
  d.delegate("gettimeallowed", "click", "button", function() {
    var a = this.textContent;
    "Reset" == a ? (Ca = ta = "30", d._("gta2_input").value = ta) : (h.hideDialog("gettimeallowed"), "Apply" === a && (ta = Ca));
  });
  d.delegate(document.body, "keyup", "#gta2_input", function(a) {
    a = a.target.value;
    H(a) ? d._("gta2_input").value = Ca : Ca = a;
  });
  var wa, va, L = "New game", B = -2, Lb, Ra, Mb, Sa, ba, T, Oa, Na, nb, Z, P, J, Q, ja, Pa, U = 0, W = document.getElementById("back_sound"), la = document.getElementById("backQTime_sound"), Ua = document.getElementById("backQ_sound"), qa = !1, Ma = !1, Va = -1, aa;
  d._("gobutton").addEventListener("click", function() {
    var a = this;
    if ("New game" === L) {
      sb();
      wa = [];
      var c = {};
      ec(wa, c) ? (va = c.n, 0 === va ? h.showMessage({msg:"There are no questions in the selection pool", bc:"w",}) : (m(), h.loadingOn({loadmsg:"Preparing the test, please wait"}), document.getElementById("tem_info").innerHTML = h.getHtml("wrapper"), d.qs("#wrapper .info").classList.add("nodisplay"), Promise.all([ma(), ib()]).then(function(b) {
        h.loadingOff();
        "end" === b[1] ? (h.showMessage({msg:"There are no valid questions in the selection pool", bc:"w",}), p()) : (b = d._("thescore"), b.style.backgroundColor = "", b.innerHTML = "0/0", d._("scorecontainer").classList.remove("nodisplay"), ba = Ba, ba > va && (ba = va), document.getElementById("score_input").value = ba, h.checkHeight(), h.checkWidth(), L = "Start", a.textContent = L, a.style.backgroundColor = "#0f0", W.currentTime = 0, la.currentTime = 0, Ua.currentTime = 0, Qa(), B = -1);
      }))) : alert("fault with fillTestQ");
    } else {
      "Start" === L ? (L = "End", a.textContent = L, a.style.backgroundColor = "#f00", da(), T < ba && (nb = ib())) : "End" === L && (d._("endbox").classList.add("nodisplay"), clearInterval(Sa), d._("scorecontainer").classList.add("nodisplay"), document.getElementById("clock").value = "", d._("wrappermask").classList.add("nodisplay"), p(), w(), d._("wrapper").style.backgroundColor = h.rgbaColor(ia, 0.6), L = "New game", a.textContent = L, a.style.backgroundColor = "#eee", 0 !== U && (1 === U ? W.pause() : 
      2 === U ? la.pause() : Ua.pause()), B = -2);
    }
  });
  var ka = [[], []], V = [];
  V[0] = d.qa("#clips0 audio");
  V[1] = d.qa("#clips1 audio");
  d.delegate("wrapper", "click", ".opt_class2", function(a) {
    0 == B && (this.classList.add("on_div"), clearInterval(Sa), a.stopPropagation(), a.preventDefault(), parseInt(this.id.charAt(this.id.length - 1), 10) === Ra ? hb("correct") : hb("wrong"));
  });
  d._("wrappermask").addEventListener("click", function(a) {
    a.stopPropagation();
    a.preventDefault();
    1 == B && (d._("flashbox").classList.add("nodisplay"), h.loadingOn({loadmsg:"Fetching the next question, please wait"}), nb.then(function(c) {
      h.loadingOff();
      "end" === c ? (h.showMessage({msg:"Unable to complete the test - some questions had errors", bc:"w",}), B = -1, d._("thescore").style.backgroundColor = "red") : (d._("wrappermask").classList.add("nodisplay"), da(), T < ba && (nb = ib()));
    }));
  });
  d.qs("#endbox button").addEventListener("click", function() {
    d.trigger("gobutton", "click");
  });
  var ua = !0, fa = {r1:1, r2:0.7, r3:1,};
  d.delegate("getaudiovolume", "click", "button", function() {
    "Reset" == this.textContent ? (Ha.sl_r = fa.r1, Ha.initBall(), Ia.sl_r = fa.r2, Ia.initBall(), Ja.sl_r = fa.T, Ja.initBall()) : h.hideDialog("getaudiovolume");
  });
  d.delegate("wrapper", "mouseout", ".qq", function(a) {
    Tb(a, this);
  });
  d.delegate("wrapper", "mouseout", ".opt_class2", function(a) {
    Tb(a, this);
  });
  d.delegate("wrapper", "mouseover", ".qq", function(a) {
    Ub(a, this);
  });
  d.delegate("wrapper", "mouseover", ".opt_class2", function(a) {
    Ub(a, this);
  });
  window.addEventListener("blur", function() {
    ua = !1;
    d._("bodymask").classList.remove("nodisplay");
    -2 !== B && (-1 === B || 1 === B ? qa && W.pause() : (Ma ? la.pause() : qa && W.pause(), 0 <= Va && V[aa][Va].pause()));
  });
  window.addEventListener("focus", function() {
    ua = !0;
    d._("bodymask").classList.add("nodisplay");
    -2 !== B && Qa();
  });
});
}).call(this);
